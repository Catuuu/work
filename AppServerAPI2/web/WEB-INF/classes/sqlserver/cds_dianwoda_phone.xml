<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC
        "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="cds_dianwoda_phone">
    <!--用户管理分页数据查询-->
    <select id="getPageRecord" parameterType="PageParam" resultType="HashMap">
        <![CDATA[
            select s.name storesName,dwd.* from cds_dianwoda_phone dwd
            left join cds_stores s on dwd.stores_id = s.stores_id
        ]]>
        where 1=1
        <if test="formInfo.keywords != null and formInfo.keywords != '' ">
            <![CDATA[
                AND (
                    dwd.name LIKE '%'+#{formInfo.keywords}+'%' OR
                    dwd.phone LIKE '%'+#{formInfo.keywords}+'%'
                  )
            ]]>
        </if>
        <if test="formInfo.stores_id != null and formInfo.stores_id != '' ">
            and dwd.stores_id = #{formInfo.stores_id}
        </if>
    </select>

    <!--获取已存在的手机号码-->
    <select id="getRecords" parameterType="CdsDianwodaPhone" resultType="CdsDianwodaPhone">
        <![CDATA[
            select * from cds_dianwoda_phone
            where stores_id = #{stores_id}
            and phone = #{phone}
            and id != #{id}
        ]]>
    </select>
</mapper>